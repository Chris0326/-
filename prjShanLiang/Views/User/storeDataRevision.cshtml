@model prjShanLiang.Models.Store

@{
    ViewData["Title"] = "storeDataRevision";
}

<style>
    
.card-registration .select-input.form-control[readonly]:not([disabled]) {
font-size: 1rem;
line-height: 2.15;
padding-left: .75em;
padding-right: .75em;
}
.card-registration .select-arrow {
top: 13px;
}

.gradient-custom-2 {
/* fallback for old browsers */
background: #a1c4fd;

/* Chrome 10-25, Safari 5.1-6 */
background: -webkit-linear-gradient(to right, rgba(161, 196, 253, 1), rgba(194, 233, 251, 1));

/* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
background: linear-gradient(to right, #F0FFF0/*rgba(161, 196, 253, 1)*/, rgba(194, 233, 251, 1))
}

.bg-indigo {
        background-color: #CAFFFF;
}
</style>



<div class="breadcrumbs">
    <div class="container">

        <div class="d-flex justify-content-between align-items-center">
            <h2>首頁</h2>
            <ol>
                <li><a a asp-controller="Home" asp-action="Index">Home</a></li>
                <li>Index</li>
            </ol>
        </div>

    </div>
</div><!-- End Breadcrumbs -->
....................................
<section class="h-100 h-custom gradient-custom-2">

    <form asp-action="storeDataRevision2">
    <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-12">
                <div class="card card-registration card-registration-2" style="border-radius: 15px;">
                    <div class="card-body p-0">
                        <div class="row g-0">
                            <div class="col-lg-6">
                                <div class="p-5">
                                    <h3 class="fw-normal mb-5" style="color: #4835d4;">General Infomation</h3>

                                    <div class="row">
                                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                            <input type="hidden" value="@Model.StoreId" name="StoreId" />
                                            <div class="form-group">
                                                <label asp-for="AccountName" class="control-label">帳號</label>
                                                <label asp-for="AccountName" class="form-control form-control-lg">@Model.AccountName </label>
                                                <span asp-validation-for="AccountName" class="text-danger"></span>
                                            </div>

                                            <div class="form-group">
                                                <label asp-for="RestaurantName" class="control-label">餐廳名稱</label>
                                                <input asp-for="RestaurantName" class="form-control" />
                                                <span asp-validation-for="RestaurantName" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="RestaurantAddress" class="control-label">縣市</label>
                                                <select class="form-control" id="storeCity"></select>
                                                <span asp-validation-for="RestaurantAddress" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="RestaurantAddress" class="control-label">地區</label>
                                                <select class="form-control" id="storeDistrict"></select>
                                                <span asp-validation-for="RestaurantAddress" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="RestaurantAddress" class="control-label">餐廳地址</label>
                                                <input asp-for="RestaurantAddress" id="storeAddress" class="form-control" />
                                                <span asp-validation-for="RestaurantAddress" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="RestaurantPhone" class="control-label">餐廳電話</label>
                                                <input asp-for="RestaurantPhone" class="form-control" />
                                                <span asp-validation-for="RestaurantPhone" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="Seats" class="control-label">餐廳座位數</label>
                                                <input type="number" min="0" max="500" asp-for="Seats" class="form-control" />
                                                <span asp-validation-for="Seats" class="text-danger"></span>
                                            </div>


                                            <div class="form-group">
                                                <label asp-for="OpeningTime" class="control-label">開始營業時間</label>
                                                <input asp-for="OpeningTime" class="form-control" type="time" />
                                                <span asp-validation-for="OpeningTime" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="ClosingTime" class="control-label">結束營業時間</label>
                                                <input asp-for="ClosingTime" class="form-control" type="time" />
                                                <span asp-validation-for="ClosingTime" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="Website" class="control-label">餐廳網站</label>
                                                <input asp-for="Website" class="form-control" />
                                                <span asp-validation-for="Website" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="StoreImage" class="control-label">餐廳圖片</label>
                                                @{
                                                    string imageName = Model.RestaurantName + ".jpg";
                                                }
                                                <img src="~/images/store/@imageName" alt="店內環境" width="80" height="60" />

                                                <span asp-validation-for="StoreImage" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="Rating" class="control-label">評分</label>
                                                <label asp-for="Rating" class="form-control">@Model.Rating</label>
                                                <span asp-validation-for="Rating" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="StoreMail" class="control-label">餐廳Email</label>
                                                <input asp-for="StoreMail" class="form-control" />
                                                <span asp-validation-for="StoreMail" class="text-danger"></span>
                                            </div>
                                            <div class="form-group">
                                                <label asp-for="Password" class="control-label" placeholder="" for="storePassword">新密碼</label>
                                                <label>
                                                    <input type="checkbox" name="showPassword" id="chkShowPassword" />顯示密碼
                                                </label>
                                                <input asp-for="Password" class="form-control" placeholder="請輸入8-16個字元，包含英文大寫、小寫及數字" type="password" id="storePassword" value="" maxlength="16" />
                                                <span asp-validation-for="Password" class="text-danger"></span>
                                            </div>

                                            <div class="form-group">
                                                <label for="storePasswordChecking" class="control-label">密碼確認</label>
                                                <input type="password" name="passwordChecking" placeholder="請再次輸入密碼" id="storePasswordChecking" class="form-control" maxlength="16" />

                                            </div>


                                            <div class="form-group">
                                                <input type="submit" value="送出" class="btn btn-primary" id="btnDataRevision" />
                                            </div>

                                            <div class="col-md-6 mb-4 pb-2">

                                            <div class="form-outline">
                                                <input type="text" id="form3Examplev2" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplev2">First name</label>
                                            </div>

                                        </div>
                                        <div class="col-md-6 mb-4 pb-2">

                                            <div class="form-outline">
                                                <input type="text" id="form3Examplev3" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplev3">Last name</label>
                                            </div>

                                        </div>
                                    </div>

                                    <div class="mb-4 pb-2">
                                        <select class="select">
                                            <option value="1">Position</option>
                                            <option value="2">Two</option>
                                            <option value="3">Three</option>
                                            <option value="4">Four</option>
                                        </select>
                                    </div>

                                    <div class="mb-4 pb-2">
                                        <div class="form-outline">
                                            <input type="text" id="form3Examplev4" class="form-control form-control-lg" />
                                            <label class="form-label" for="form3Examplev4">Position</label>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6 mb-4 pb-2 mb-md-0 pb-md-0">

                                            <div class="form-outline">
                                                <input type="text" id="form3Examplev5" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplev5">Bussines Arena</label>
                                            </div>

                                        </div>
                                        <div class="col-md-6">

                                            <select class="select">
                                                <option value="1">Employees</option>
                                                <option value="2">Two</option>
                                                <option value="3">Three</option>
                                                <option value="4">Four</option>
                                            </select>

                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-lg-6 bg-indigo text-white">
                                <div class="p-5">
                                    <h3 class="fw-normal mb-5">Contact Details</h3>

                                    <div class="mb-4 pb-2">
                                        <div class="form-outline form-white">
                                            <input type="text" id="form3Examplea2" class="form-control form-control-lg" />
                                            <label class="form-label" for="form3Examplea2">Street + Nr</label>
                                        </div>
                                    </div>

                                    <div class="mb-4 pb-2">
                                        <div class="form-outline form-white">
                                            <input type="text" id="form3Examplea3" class="form-control form-control-lg" />
                                            <label class="form-label" for="form3Examplea3">Additional Information</label>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-5 mb-4 pb-2">

                                            <div class="form-outline form-white">
                                                <input type="text" id="form3Examplea4" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplea4">Zip Code</label>
                                            </div>

                                        </div>
                                        <div class="col-md-7 mb-4 pb-2">

                                            <div class="form-outline form-white">
                                                <input type="text" id="form3Examplea5" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplea5">Place</label>
                                            </div>

                                        </div>
                                    </div>

                                    <div class="mb-4 pb-2">
                                        <div class="form-outline form-white">
                                            <input type="text" id="form3Examplea6" class="form-control form-control-lg" />
                                            <label class="form-label" for="form3Examplea6">Country</label>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-5 mb-4 pb-2">

                                            <div class="form-outline form-white">
                                                <input type="text" id="form3Examplea7" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplea7">Code +</label>
                                            </div>

                                        </div>
                                        <div class="col-md-7 mb-4 pb-2">

                                            <div class="form-outline form-white">
                                                <input type="text" id="form3Examplea8" class="form-control form-control-lg" />
                                                <label class="form-label" for="form3Examplea8">Phone Number</label>
                                            </div>

                                        </div>
                                    </div>

                                    <div class="mb-4">
                                        <div class="form-outline form-white">
                                            <input type="text" id="form3Examplea9" class="form-control form-control-lg" />
                                            <label class="form-label" for="form3Examplea9">Your Email</label>
                                        </div>
                                    </div>

                                    <div class="form-check d-flex justify-content-start mb-4 pb-3">
                                        <input class="form-check-input me-3" type="checkbox" value="" id="form2Example3c" />
                                        <label class="form-check-label text-white" for="form2Example3">
                                            I do accept the <a href="#!" class="text-white"><u>Terms and Conditions</u></a> of your
                                            site.
                                        </label>
                                    </div>

                                    <button type="button" class="btn btn-light btn-lg"
                                            data-mdb-ripple-color="dark">
                                        Register
                                    </button>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </form>
    <div id="errorMessage1"></div>

    @section Scripts {
        <script>


            const Password1 = document.getElementById('storePassword');
            const Password2 = document.getElementById('storePasswordChecking');
            const errorMessage = document.getElementById('errorMessage1');
            const btnDataRevision = document.getElementById('btnDataRevision');
            const chkShowPassword = document.getElementById('chkShowPassword');
            const storeDataRevision = document.getElementById('storeDataRevision');
            const storeCity = document.getElementById('storeCity');
            const storeDistrict = document.getElementById('storeDistrict');
            const storeAddress = document.getElementById('storeAddress');

            let errorString = '';
            btnDataRevision.disabled = false
            let pattern = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,16}$/;
            let result = false



            Password1.addEventListener('input',
                function (event) {
                    // 錯誤訊息用字串
                    if (Password1.value) {
                        errorString = ''
                        result = pattern.test(Password1.value)
                        if (!Password1.value) {
                            errorString += '請填寫密碼'
                        }
                        if (!Password2.value) {
                            errorString += ' 請確認密碼'
                        }
                        if (Password1.value !== Password2.value) {
                            errorString += ' 兩次輸入的密碼不同'
                        }
                        if (!result) {
                            errorString += ' 密碼強度不足'
                        }
                        errorMessage.innerText = (errorString) ? errorString : '密碼一致'

                        if (!errorString) {
                            btnDataRevision.disabled = false
                        }
                        if (errorString) {
                            btnDataRevision.disabled = true
                        }
                    }
                })
            Password2.addEventListener('input',
                function (event) {
                    // 錯誤訊息用字串
                    if (Password1.value) {
                        errorString = ''
                        result = pattern.test(Password1.value)
                        if (!Password1.value) {
                            errorString += ' 密碼沒填'
                        }
                        if (!Password2.value) {
                            errorString += ' 密碼確認沒填'
                        }
                        if (Password1.value !== Password2.value) {
                            errorString += ' 兩次輸入的密碼不同'
                        }
                        if (!result) {
                            errorString += ' 密碼強度不足'
                        }
                        errorMessage.innerText = (errorString) ? errorString : '密碼一致'

                        if (!errorString) {
                            btnDataRevision.disabled = false
                        }
                        if (errorString) {
                            btnDataRevision.disabled = true
                        }
                    }
                })
            //await Html.RenderPartialAsync("_ValidationScriptsPartial");
            chkShowPassword.addEventListener('change', (event) => {
                if (event.currentTarget.checked) {
                    Password1.type = "text"
                    Password2.type = "text"
                }
                else {
                    Password1.type = "password"
                    Password2.type = "password"
                }
            })
            storeCity.addEventListener('mousedown', async () => {
                const response = await fetch('@Url.Content("~/User/GetCities")')
                const datas = await response.json();
                const cities = datas.map(data => {
                    return (
                        `<option value=${data}>${data}</option>`
                    )
                })
                storeCity.innerHTML = cities.join("");
            })

            storeDistrict.addEventListener('mousedown', async () => {
                let num = storeCity.selectedIndex
                let chosenCity = storeCity.options[num].text

                const response = await fetch('@Url.Content("~/User/GetDistricts")?storeCity=' + chosenCity)
                const datas = await response.json();

                const districts = datas.map(data => {
                    return (
                        `<option value=${data}>${data}</option>`
                    )
                })
                storeDistrict.innerHTML = districts.join("");
            })

            let addressString = ""

            storeCity.addEventListener('change', function () {
                addressString = ""
                let num = storeCity.selectedIndex
                let chosenCity = storeCity.options[num].text
                addressString += chosenCity
                storeAddress.value = addressString
                console.log(chosenCity)
            })

            storeDistrict.addEventListener('change', function () {
                //if (addressString.contains(chosenDistrict)){
                //     addressString = ""
                // }
                let num = storeDistrict.selectedIndex
                let chosenDistrict = storeDistrict.options[num].text

                addressString += chosenDistrict
                storeAddress.value = addressString


            })

            //@{
                await Html.RenderPartialAsync("_ValidationScriptsPartial");
            }
        </script>
    }
</section>
@*<section class="sample-page">*@
    <div class="container" data-aos="fade-up">
        <div>
            <a asp-action="storeManagement">回到餐廳管理中心</a>
        </div>
.................................
@*

<h1>修改餐廳資料</h1>


<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="storeDataRevision2">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <input type="hidden" value="@Model.StoreId" name="StoreId" />
            <div class="form-group">
                <label asp-for="AccountName" class="control-label">帳號</label>
                <label asp-for ="AccountName" class="form-control">@Model.AccountName </label>
                <span asp-validation-for="AccountName" class="text-danger"></span>
            </div>
            
            <div class="form-group">
                <label asp-for="RestaurantName" class="control-label">餐廳名稱</label>
                <input asp-for="RestaurantName" class="form-control" />
                <span asp-validation-for="RestaurantName" class="text-danger"></span>
            </div>
                    <div class="form-group">
                        <label asp-for="RestaurantAddress" class="control-label">縣市</label>
                        <select class="form-control" id="storeCity"></select>
                        <span asp-validation-for="RestaurantAddress" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="RestaurantAddress" class="control-label">地區</label>
                        <select class="form-control" id="storeDistrict"></select>
                        <span asp-validation-for="RestaurantAddress" class="text-danger"></span>
                    </div>
            <div class="form-group">
                <label asp-for="RestaurantAddress" class="control-label">餐廳地址</label>
                <input asp-for="RestaurantAddress" id="storeAddress" class="form-control" />
                <span asp-validation-for="RestaurantAddress" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="RestaurantPhone" class="control-label">餐廳電話</label>
                <input asp-for="RestaurantPhone" class="form-control" />
                <span asp-validation-for="RestaurantPhone" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Seats" class="control-label">餐廳座位數</label>
                <input type="number"min="0" max="500" asp-for="Seats" class="form-control" />
                <span asp-validation-for="Seats" class="text-danger"></span>
            </div>
            
           
            <div class="form-group">
                <label asp-for="OpeningTime" class="control-label">開始營業時間</label>
                <input asp-for="OpeningTime" class="form-control" type="time" />
                <span asp-validation-for="OpeningTime" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="ClosingTime" class="control-label">結束營業時間</label>
                <input asp-for="ClosingTime" class="form-control" type="time" />
                <span asp-validation-for="ClosingTime" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Website" class="control-label">餐廳網站</label>
                <input asp-for="Website" class="form-control" />
                <span asp-validation-for="Website" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="StoreImage" class="control-label">餐廳圖片</label>
                        @{
                            string imageName = Model.RestaurantName + ".jpg";
                        }
                        <img src="~/images/store/@imageName" alt="店內環境" width="80" height="60" />
                        
                <span asp-validation-for="StoreImage" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Rating" class="control-label">評分</label>
                        <label  asp-for="Rating" class="form-control">@Model.Rating</label>
                <span asp-validation-for="Rating" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="StoreMail" class="control-label">餐廳Email</label>
                <input asp-for="StoreMail" class="form-control" />
                <span asp-validation-for="StoreMail" class="text-danger"></span>
            </div>
             <div class="form-group">
                        <label asp-for="Password" class="control-label" placeholder="" for="storePassword">新密碼</label>
                        <label>
                            <input type="checkbox" name="showPassword" id="chkShowPassword" />顯示密碼
                        </label>
                        <input asp-for="Password" class="form-control" placeholder="請輸入8-16個字元，包含英文大寫、小寫及數字" type="password" id="storePassword" value="" maxlength="16" />
                        <span asp-validation-for="Password" class="text-danger"></span>
              </div>

              <div class="form-group">
                        <label for="storePasswordChecking" class="control-label">密碼確認</label>
                        <input type="password" name="passwordChecking" placeholder="請再次輸入密碼" id="storePasswordChecking" class="form-control" maxlength="16" />

              </div>


            <div class="form-group">
                        <input type="submit" value="送出" class="btn btn-primary" id="btnDataRevision" />
            </div>
             
        </form>
        <div id="errorMessage1" ></div>
        
    </div>
</div>

<div>
            <a asp-action="storeManagement">回到餐廳管理中心</a>
</div>

@section Scripts {
    <script>

   
        const Password1 = document.getElementById('storePassword');
        const Password2 = document.getElementById('storePasswordChecking');
        const errorMessage = document.getElementById('errorMessage1');
        const btnDataRevision = document.getElementById('btnDataRevision');
        const chkShowPassword = document.getElementById('chkShowPassword');
        const storeDataRevision = document.getElementById('storeDataRevision');
        const storeCity = document.getElementById('storeCity');
        const storeDistrict = document.getElementById('storeDistrict');
                const storeAddress = document.getElementById('storeAddress');

                let errorString = '';
        btnDataRevision.disabled = false
        let pattern = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,16}$/;
        let result = false



        Password1.addEventListener('input',
        function (event) {
        // 錯誤訊息用字串
            if (Password1.value){
                errorString = ''
                result = pattern.test(Password1.value)
                if (!Password1.value) {
                errorString += '請填寫密碼'
                }
                if (!Password2.value) {
                errorString += ' 請確認密碼'
                }
                if (Password1.value !== Password2.value) {
                errorString += ' 兩次輸入的密碼不同'
                }
                if (!result) {
                errorString += ' 密碼強度不足'
                }
                errorMessage.innerText = (errorString) ? errorString : '密碼一致'

                if (!errorString) {
                btnDataRevision.disabled = false
                }
                if (errorString) {
                btnDataRevision.disabled = true
                }
            }
        })
        Password2.addEventListener('input',
        function (event) {
        // 錯誤訊息用字串
            if (Password1.value){
            errorString = ''
            result = pattern.test(Password1.value)
                if (!Password1.value) {
                errorString += ' 密碼沒填'
                }
                if (!Password2.value) {
                errorString += ' 密碼確認沒填'
                }
                if (Password1.value !== Password2.value) {
                errorString += ' 兩次輸入的密碼不同'
                }
                if (!result) {
                errorString += ' 密碼強度不足'
                }
                errorMessage.innerText = (errorString) ? errorString : '密碼一致'

                if (!errorString) {
                btnDataRevision.disabled = false
                }
                if (errorString) {
                btnDataRevision.disabled = true
                }
            }
        })
        //await Html.RenderPartialAsync("_ValidationScriptsPartial");
        chkShowPassword.addEventListener('change', (event) => {
            if (event.currentTarget.checked) {
                Password1.type = "text"
                Password2.type = "text"
            }
            else {
                Password1.type = "password"
                Password2.type = "password"
            }
        })
        storeCity.addEventListener('mousedown',async ()=>{
           const response = await fetch('@Url.Content("~/User/GetCities")')
           const datas = await response.json();
           const cities = datas.map(data=>{
               return(
                    `<option value=${data}>${data}</option>`
               )
           })
                    storeCity.innerHTML = cities.join("");
        })

        storeDistrict.addEventListener('mousedown', async () => {
             let num = storeCity.selectedIndex
             let chosenCity= storeCity.options[num].text

                    const response = await fetch('@Url.Content("~/User/GetDistricts")?storeCity=' + chosenCity)
             const datas = await response.json();
                   
             const districts = datas.map(data=>{
                 return(
                    `<option value=${data}>${data}</option>`
                 )
            })
            storeDistrict.innerHTML = districts.join("");
        })

        let addressString=""

            storeCity.addEventListener('change', function(){
                    addressString = ""
                    let num = storeCity.selectedIndex
                    let chosenCity = storeCity.options[num].text
                    addressString += chosenCity
                    storeAddress.value = addressString
                    console.log(chosenCity)
                })

                storeDistrict.addEventListener('change', function () {
                   //if (addressString.contains(chosenDistrict)){
                   //     addressString = ""
                   // }
                    let num = storeDistrict.selectedIndex
                    let chosenDistrict = storeDistrict.options[num].text
                    
                    addressString += chosenDistrict
                    storeAddress.value = addressString

                    
                })

    //@{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
        </script>
}
    </div>
</section>

</main><!-- End #main -->*@